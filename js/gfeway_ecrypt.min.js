// Gravity Forms eWAY
// https://shop.webaware.com.au/downloads/gravity-forms-eway/

"use strict";!function(e){e(document).on("gform_post_render",function(t,n){e("#gform_"+n+"[data-gfeway-encrypt-key]").on("submit",r)});var t="function"==typeof String.prototype.repeat?function(e,t){return e.repeat(t)}:function(e,t){for(var r=e,n=1;n<t;n++)r+=e;return r};function r(r){var n,a,i=e(this),f=(n=this.id,(a=n.split("_")).length>1?a[1]:"");if(i.find(".gfeway-recurring-active").length)return!0;var o=i.data("gfeway-encrypt-key");function p(r){var n=i.find(r);if(n.length){var a=n.val().trim(),f=a.length,p=n.data("gfeway-encrypt-name");if("EWAY_CARDNUMBER"===p&&!function(e){for(var t=0,r=1,n=e.length-1;n>=0;n--){var a=e.charAt(n)*r;r=1===r?2:1,a>=10&&(t++,a-=10),t+=a}return t%10==0}(a))throw{name:"Credit Card Error",message:gfeway_ecrypt_strings.card_number_invalid,field:n};if(f){var c=eCrypt.encryptValue(n.val(),o);e("<input type='hidden'>").attr("name",p).val(c).appendTo(i),n.val("").prop("placeholder",t(gfeway_ecrypt_strings.ecrypt_mask,f))}}}try{p("input[data-gfeway-encrypt-name='EWAY_CARDNUMBER']"),p("input[data-gfeway-encrypt-name='EWAY_CARDCVN']")}catch(t){r.preventDefault(),window["gf_submitting_"+f]=!1,e("#gform_ajax_spinner_"+f).remove(),t.field.focus(),window.alert(t.message)}return!0}}(jQuery);