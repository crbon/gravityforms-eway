// Gravity Forms Eway
// https://shop.webaware.com.au/downloads/gravity-forms-eway/

!function(f){f(document).on("gform_post_render",function(e,t){f("#gform_"+t+"[data-gfeway-encrypt-key]").on("submit",r)});var o="function"==typeof String.prototype.repeat?function(e,t){return e.repeat(t)}:function(e,t){for(var r=e,n=1;n<t;n++)r+=e;return r};function r(t){var a=f(this),r=function(e){e=e.split("_");return 1<e.length?e[1]:""}(this.id);if(a.find(".gfeway-recurring-active").length)return!0;var i=a.data("gfeway-encrypt-key");function e(e){var t=a.find(e);if(t.length){var r=t.val().trim(),n=r.length,e=t.data("gfeway-encrypt-name");if("EWAY_CARDNUMBER"===e&&!function(e){for(var t=0,r=1,n=e.length-1;0<=n;n--){var a=e.charAt(n)*r;r=1===r?2:1,10<=a&&(t++,a-=10),t+=a}return t%10==0}(r))throw{name:"Credit Card Error",message:gfeway_ecrypt_strings.card_number_invalid,field:t};n&&(r=eCrypt.encryptValue(t.val(),i),f("<input type='hidden'>").attr("name",e).val(r).appendTo(a),t.val("").prop("placeholder",o(gfeway_ecrypt_strings.ecrypt_mask,n)))}}try{e("input[data-gfeway-encrypt-name='EWAY_CARDNUMBER']"),e("input[data-gfeway-encrypt-name='EWAY_CARDCVN']")}catch(e){t.preventDefault(),window["gf_submitting_"+r]=!1,f("#gform_ajax_spinner_"+r).remove(),e.field.focus(),window.alert(e.message)}return!0}}(jQuery);